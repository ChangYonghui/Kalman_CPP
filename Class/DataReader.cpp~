#include "../Headers/DataReader.h"
#include <iostream>
#include <string>
#include <stdio.h>
#include <stdlib.h>


using namespace std;

DataReader::DataReader(std::string n){      
        this->result="";
        this->topic_name=n;
}

//Affichage des données dans le buffer
void DataReader::Display(){

        cout << "Nom du topic à lire : " << this->topic_name << endl;     
        cout << this->result << endl;       

}

void DataReader::Reading(){

         std::string cmd= "rostopic echo /"+this->topic_name;
         FILE *pipe = popen(cmd._str(),"r");
         char buf[128];
         std::string res="";
         bool test=false;
         
     
        while(test==false){
                if(fgets(buf,128,pipe)!=NULL){
                        res+=buf;     
                        test=true;    
                }        
        }
    
         
         this->result=res;
         pclose(pipe);

}
